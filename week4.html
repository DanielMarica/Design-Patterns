<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semaine 4 - Pattern State</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Design Patterns en Java</h1>
            <p>Bachelier Informatique 2022-2026</p>
        </header>

        <nav>
            <a href="index.html">Accueil</a>
            <a href="week1.html">Semaine 1</a>
            <a href="week4.html">Semaine 4</a>
        </nav>

        <main>
            <h2>Semaine 4 : Pattern State</h2>

            <div class="week-list">
                <!-- Section Th√©orie -->
                <div class="week-item">
                    <h3>Th√©orie</h3>

                    <h4>Comment le reconna√Ætre ?</h4>
                    <p>
                        Je reconnais <strong>State</strong> gr√¢ce √† un <strong>enum State</strong> ou des <strong>classes d'√©tats</strong> 
                        et une m√©thode <strong>setState()</strong>. L'objet d√©l√®gue le comportement √† son √©tat actuel 
                        via <code>state.methodName()</code>, et l'√©tat peut changer dynamiquement durant l'ex√©cution.
                    </p>

                    <h4>D√©finition</h4>
                    <p>
                        Le pattern <strong>State</strong> est un pattern comportemental qui permet √† un objet de changer 
                        son comportement lorsque son √©tat interne change. Il appara√Æt comme si l'objet changeait de classe.
                    </p>

                    <h4>Diagramme UML du Pattern State</h4>
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="assets/th/State.png" alt="Diagramme UML du Pattern State" style="max-width: 100%; border: 1px solid #ccc; padding: 10px; background-color: white;">
                    </div>

                    <h4>Composants du Pattern State</h4>
                    <ul>
                        <li><strong>Context</strong> : Maintient une r√©f√©rence √† l'√©tat actuel et d√©l√®gue le comportement √† cet √©tat</li>
                        <li><strong>State Interface/Enum</strong> : D√©finit les m√©thodes communes pour tous les √©tats</li>
                        <li><strong>Concrete States</strong> : Impl√©mentent le comportement sp√©cifique √† chaque √©tat</li>
                    </ul>

                    <h4>Quand utiliser State ?</h4>
                    <ul>
                        <li>Quand un objet a un comportement diff√©rent selon son √©tat actuel</li>
                        <li>Quand vous avez beaucoup de conditions if/else ou switch bas√©es sur l'√©tat</li>
                        <li>Quand les transitions d'√©tats sont complexes et doivent √™tre encapsul√©es</li>
                    </ul>
                </div>

                <!-- Section Correspondance Th√©orie/Exercice -->
                <div class="week-item">
                    <h3>üìã Correspondance Th√©orie ‚Üî Exercice</h3>

                    <table>
                        <tr>
                            <th>Nom Th√©orique (Pattern)</th>
                            <th>Nom dans l'Exercice</th>
                            <th>R√¥le</th>
                        </tr>
                        <tr>
                            <td><strong>Context</strong></td>
                            <td><code>Bear</code></td>
                            <td>Objet qui change de comportement selon son √©tat</td>
                        </tr>
                        <tr>
                            <td><strong>State (interface/enum)</strong></td>
                            <td><code>enum State</code></td>
                            <td>D√©finit les √©tats possibles et leurs comportements</td>
                        </tr>
                        <tr>
                            <td><strong>ConcreteState</strong></td>
                            <td><code>SLEEPING</code>, <code>NOTSLEEPING</code>, <code>ANGRY</code></td>
                            <td>√âtats concrets avec comportements sp√©cifiques</td>
                        </tr>
                        <tr>
                            <td><strong>setState()</strong></td>
                            <td><code>setState(State state)</code></td>
                            <td>Changer l'√©tat du contexte</td>
                        </tr>
                        <tr>
                            <td><strong>state.handle()</strong></td>
                            <td><code>state.attack()</code>, <code>state.sleep()</code></td>
                            <td>D√©l√©guer le comportement √† l'√©tat actuel</td>
                        </tr>
                        <tr>
                            <td><strong>transition()</strong></td>
                            <td><code>sleep()</code>, <code>wakeup()</code>, <code>angry()</code></td>
                            <td>M√©thodes de transition entre √©tats</td>
                        </tr>
                    </table>

                    <p style="margin-top: 15px;">
                        <strong>üí° Point cl√© :</strong> Dans cet exercice, l'<code>enum State</code> combine 
                        l'interface State et les ConcreteStates en une seule structure. Chaque valeur de l'enum 
                        (<code>SLEEPING</code>, <code>NOTSLEEPING</code>, <code>ANGRY</code>) est un ConcreteState.
                    </p>
                </div>

                <!-- Section Exercice -->
                <div class="week-item">
                    <h3>Exercice : L'Ours (Bear)</h3>
                    <p><strong>Description :</strong> Impl√©mentation du pattern State pour g√©rer les diff√©rents √©tats d'un ours.</p>
                    <p><strong>Pattern utilis√© :</strong> State</p>

                    <h4>√ânonc√© de l'Exercice</h4>
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="assets/exos/StateExos.png" alt="√ânonc√© de l'exercice State" style="max-width: 100%; border: 1px solid #ccc; padding: 10px; background-color: white;">
                    </div>

                    </table>

                    <h4>Code Principal</h4>
                    <p>Copiez chaque bloc individuellement pour construire votre solution.</p>

                    <pre><code>// CLASSE : Bear.java
package be.vinci;

public class Bear {

    public enum State {
        SLEEPING {
            @Override
            public void attack(Bear b) {
                System.out.println("grrrr");
            }

            @Override
            public void sleep(Bear b) {
                throw new RuntimeException("Already sleeping");
            }
        },
        NOTSLEEPING {
            @Override
            public void attack(Bear b) {
                System.out.println("ROARRRR");
            }

            @Override
            public void wakeup(Bear b) {
                throw new RuntimeException("already wak up");
            }
        },
        ANGRY {
            @Override
            public void attack(Bear b) {
                System.out.println("MEGA ROARRRR !!!");
            }

            @Override
            public void angry(Bear b) {
                throw new RuntimeException("already angry");
            }

            // ANGRY peut se calmer via wakeup()
            // On h√©rite de State.wakeup() qui change vers NOTSLEEPING
        };

        public abstract void attack(Bear b);

        public void sleep(Bear b) {
            b.setState(State.SLEEPING);
        }

        public void wakeup(Bear b) {
            b.setState(State.NOTSLEEPING);
        }

        public void angry(Bear b) {
            b.setState(State.ANGRY);
        }
    }

    private State state;

    public Bear() {
        setState(State.NOTSLEEPING);
    }

    public void attack() {
        state.attack(this);
    }

    public void sleep() {
        state.sleep(this);
    }

    public void wakeup() {
        state.wakeup(this);
    }

    public void angry() {
        state.angry(this);
    }

    public void setState(State state) {
        this.state = state;
    }

    public static void main(String[] args) {
        Bear b = new Bear();

        System.out.println("1. L'ours attaque (NOTSLEEPING):");
        b.attack(); // ‚Üí ROARRRR

        System.out.println("\n2. L'ours dort:");
        b.sleep(); // ‚Üí Passe √† SLEEPING

        System.out.println("\n3. L'ours se r√©veille:");
        b.wakeup(); // ‚Üí Passe √† NOTSLEEPING

        System.out.println("\n4. L'ours attaque (NOTSLEEPING):");
        b.attack(); // ‚Üí ROARRRR

        System.out.println("\n5. L'ours devient en col√®re:");
        b.angry(); // ‚Üí Passe √† ANGRY

        System.out.println("\n6. L'ours attaque (ANGRY):");
        b.attack(); // ‚Üí MEGA ROARRRR !!!

        System.out.println("\n7. L'ours se calme (wakeup depuis ANGRY):");
        b.wakeup(); // ‚Üí Passe √† NOTSLEEPING (se calme)

        System.out.println("\n8. L'ours attaque (NOTSLEEPING):");
        b.attack(); // ‚Üí ROARRRR

        System.out.println("\n9. L'ours dort:");
        b.sleep(); // ‚Üí Passe √† SLEEPING
    }
}</code></pre>

                    <h4>R√©sultat Attendu</h4>
                    <pre><code>1. L'ours attaque (NOTSLEEPING):
ROARRRR

2. L'ours dort:

3. L'ours se r√©veille:

4. L'ours attaque (NOTSLEEPING):
ROARRRR

5. L'ours devient en col√®re:

6. L'ours attaque (ANGRY):
MEGA ROARRRR !!!

7. L'ours se calme (wakeup depuis ANGRY):

8. L'ours attaque (NOTSLEEPING):
ROARRRR

9. L'ours dort:</code></pre>
                </div>

                <!-- Section MEMO Technique -->
                <div class="week-item">
                    <h3>MEMO Technique : State vs Strategy</h3>

                    <h4>State = CHANGEMENT d'√©tat (Machine √† √©tats)</h4>
                    <p>
                        Imaginez un feu de circulation. Il change automatiquement d'√©tat :
                    </p>
                    <ul>
                        <li>üî¥ Rouge ‚Üí üü¢ Vert ‚Üí üü° Jaune ‚Üí üî¥ Rouge</li>
                    </ul>
                    <p>
                        Chaque couleur (√©tat) a son propre comportement, et le feu <strong>change d'√©tat durant son fonctionnement</strong>.
                    </p>
                    <p>
                        <strong>Dans le code :</strong> Le pattern State permet √† un objet de changer son comportement 
                        en fonction de son √©tat interne. L'√©tat peut changer plusieurs fois pendant la vie de l'objet.
                    </p>

                    <h4>Strategy = CHOIX unique (S√©lection d'algorithme)</h4>
                    <p>
                        Imaginez que vous choisissez un mode de paiement en ligne :
                    </p>
                    <ul>
                        <li>üí≥ Carte bancaire OU</li>
                        <li>üì± PayPal OU</li>
                        <li>üè¶ Virement bancaire</li>
                    </ul>
                    <p>
                        Vous choisissez UNE m√©thode au moment du paiement, et ce choix ne change pas pendant le processus.
                    </p>
                    <p>
                        <strong>Dans le code :</strong> Le pattern Strategy sert √† choisir <em>une seule fa√ßon</em> 
                        de faire quelque chose √† un moment donn√©, g√©n√©ralement d√©finie au d√©part ou chang√©e rarement.
                    </p>

                    <h4>Tableau Comparatif</h4>
                    <table>
                        <tr>
                            <th>Pattern</th>
                            <th>Mot-cl√©</th>
                            <th>Changement</th>
                            <th>Exemple</th>
                        </tr>
                        <tr>
                            <td>State</td>
                            <td>Transformer</td>
                            <td>L'√©tat change automatiquement pendant l'ex√©cution</td>
                            <td>Feu de circulation, Ours qui dort/se r√©veille</td>
                        </tr>
                        <tr>
                            <td>Strategy</td>
                            <td>Choisir</td>
                            <td>On choisit une strat√©gie, elle reste fixe</td>
                            <td>Mode de paiement, Algorithme de tri</td>
                        </tr>
                    </table>

                    <h4>Pour l'Ours (Bear)</h4>
                    <p>
                        Dans notre exemple de l'ours, on utilise <strong>State</strong> car :
                    </p>
                    <ul>
                        <li>L'ours change d'√©tat plusieurs fois : NOTSLEEPING ‚Üí SLEEPING ‚Üí NOTSLEEPING ‚Üí ANGRY</li>
                        <li>Chaque √©tat a un comportement diff√©rent pour <code>attack()</code></li>
                        <li>Les transitions sont g√©r√©es par l'√©tat lui-m√™me</li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 Bachelier Informatique - Design Patterns</p>
        </footer>
    </div>
</body>
</html>